<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<!-- CSS only -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
		integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
		integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
		crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>

	<form action="#" th:action="@{/createUser}" method="post" th:object="${user}" style="width:80%;margin:5% auto"
		class="text-center w-25">
		<div>User Registeration<div>
				<div class="form-group text-left ">

					<label for="username" class="form-label">User Name</label>
					<input type="text" class="form-control" id="username" th:field="*{userName}">
				</div>
				<div class="form-group text-left">
					<label for="username" class="form-label">First Name</label>
					<input type="text" class="form-control" id="username" th:field="*{userFirstName}">
				</div>
				<div class="form-group text-left">
					<label for="username" class="form-label">Last Name</label>
					<input type="text" class="form-control" id="username" th:field="*{userLastname}">
				</div>
				<div class="form-group text-left">
					<label for="email" class="form-label">Email</label>
					<input type="email" class="form-control" id="email" th:field="*{email}">
				</div>
				<button type="submit" id="btnSubmit" class="btn btn-primary">Submit</button>


	</form>

	<script>
		$("#username").on("change", function () {
			var username = $("#username").val();
			$.ajax({
				type: "POST",
				contentType: "application/json",
				url: "http://localhost:8080/finduser/"+userName,
				data: username,
				dataType: 'jason',
				cache: false,
				timeout: 600000,
				success: function (data) {
						console.log(data);

					if (data=="1") {
						alert("user name already exists, please select another");
						//$("#btnSubmit").attr("disabled");
					}


				},
				error: function (e) {
					console.log(e);
					alert("error occured try again");
					$("#btnSubmit").attr("disabled");

				}
			});


		});

	</script>
</body>

</html>